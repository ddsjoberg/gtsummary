on:
  push:
  pull_request:

name: Continuous Benchmark

jobs:
  build:
    runs-on: macOS-latest
    steps:
      - name: Checkout repo
        uses: actions/checkout@master

      - name: Setup R
        uses: r-lib/actions/setup-r@master

      - name: Install dependencies
        run: |
          Rscript -e "install.packages(c('devtools', 'here', 'gert', 'purrr', 'usethis', 'lubridate', 'readr', 'forcats', 'ggplot2'))"

      - name: Install Pandoc
        uses: r-lib/actions/setup-pandoc@9598b8eeb6d88de7d76d580d84443542bbfdffce
        with:
          pandoc-version: 2.11.1.1

      - name: Run Benchmark Script
        run: |
          source("benchmark/benchmark_gts.R")
        shell: Rscript {0}

      # - name: Build RMD REPORT
      #   run: |
      #     Rscript -e 'install.packages(c("rmarkdown", "knitr"))'
      #             -e 'rmarkdown::render(input = here::here("benchmark/README.Rmd"), output_file = here::here("benchmark/README.md"),  clean = T)'

      - name: Commit files
        run: |
          git config --global user.email "ghau@example.com"
          git config --global user.name "GitHub Actions User"
          git add --all
          git commit -am "continous benchmark autocommit"
          git push
